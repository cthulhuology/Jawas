// CMGR handler
debug("[SMS] reading message " + $line);

var (type,number,date) = /.*"([^"]+)",\s*"([^"]+)",\s*"([^"]+)"/.match($line);

var body = "";
while (var txt = in_modem()) {
	if (txt == "OK\r\n") break;
	body += txt;
}

var msg = new Object();
msg.type = type;
msg.number = number;
msg.date = date;
msg.body = body;

